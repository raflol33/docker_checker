{% extends "base.html" %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
    <!-- Sidebar / Hosts -->
    <div class="lg:col-span-1 space-y-6">
        <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
            <h2 class="text-lg font-bold mb-4 flex items-center justify-between gap-2">
                <div class="flex items-center gap-2">
                    <span>üñ•Ô∏è</span> –£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –•–æ—Å—Ç—ã
                </div>
                <button hx-get="/containers/list" hx-target="#container-list"
                    class="text-xs bg-gray-700 hover:bg-gray-600 px-2 py-1 rounded transition text-gray-300">
                    –í—Å–µ
                </button>
            </h2>
            <ul class="space-y-2 mb-4">
                {% for host in hosts %}
                <li class="flex justify-between items-center bg-gray-700/50 p-2 rounded text-sm hover:bg-gray-700 transition group cursor-pointer"
                    hx-get="/containers/list?host_name={{ host.name }}" hx-target="#container-list">
                    <span class="font-mono group-hover:text-blue-300 font-bold transition">{{ host.name }}</span>
                    <div class="flex items-center gap-2">
                        <button
                            class="text-xs bg-purple-900/50 hover:bg-purple-800 text-purple-200 px-2 py-1 rounded border border-purple-700 transition"
                            hx-get="/images/{{ host.name }}" hx-target="body" hx-swap="beforeend"
                            onclick="event.stopPropagation()">
                            –û–±—Ä–∞–∑—ã
                        </button>
                        <span class="text-xs text-gray-400 uppercase border border-gray-600 px-1 rounded">{{ host.type
                            }}</span>
                    </div>
                </li>
                {% endfor %}
            </ul>

            <details class="text-sm">
                <summary class="cursor-pointer text-blue-400 hover:text-blue-300">–î–æ–±–∞–≤–∏—Ç—å –ù–æ–≤—ã–π –•–æ—Å—Ç</summary>
                <form action="/hosts/add" method="post" class="mt-4 space-y-3 p-2 bg-gray-700/30 rounded">
                    <input type="text" name="name" placeholder="–ò–º—è –•–æ—Å—Ç–∞"
                        class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600" required>
                    <select name="type" class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600">
                        <option value="ssh">SSH</option>
                        <option value="local">–õ–æ–∫–∞–ª—å–Ω—ã–π –°–æ–∫–µ—Ç</option>
                    </select>
                    <input type="text" name="ip" placeholder="IP –ê–¥—Ä–µ—Å (SSH)"
                        class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600">
                    <input type="number" name="port" placeholder="–ü–æ—Ä—Ç (22)"
                        class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600">
                    <input type="text" name="ssh_user" placeholder="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH"
                        class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600">
                    <input type="text" name="ssh_password" placeholder="–ü–∞—Ä–æ–ª—å SSH (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                        class="w-full bg-gray-700 rounded p-2 text-xs border border-gray-600">
                    <button class="w-full bg-green-700 hover:bg-green-600 text-white p-2 rounded text-xs">–î–æ–±–∞–≤–∏—Ç—å
                        –•–æ—Å—Ç</button>
                </form>
            </details>
        </div>


    </div>

    <!-- Main Content / Containers -->
    <div class="lg:col-span-3 space-y-6">
        {% if errors %}
        <div class="bg-red-900/50 border border-red-800 p-4 rounded text-sm text-red-200">
            <p class="font-bold">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏:</p>
            <ul class="list-disc pl-5">
                {% for err in errors %}
                <li>{{ err }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <div class="bg-gray-800 rounded-lg border border-gray-700 overflow-hidden">
            <div class="p-4 bg-gray-800 border-b border-gray-700 flex justify-between items-center">
                <h2 class="text-xl font-bold">üì¶ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</h2>
                <button onclick="location.reload()"
                    class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-gray-400 uppercase bg-gray-700/50">
                        <tr>
                            <th class="px-4 py-3">–°—Ç–∞—Ç—É—Å</th>
                            <th class="px-4 py-3">–ò–º—è</th>
                            <th class="px-4 py-3">–û–±—Ä–∞–∑</th>
                            <th class="px-4 py-3">–°–æ–∑–¥–∞–Ω</th>
                            <th class="px-4 py-3">–ü–æ—Ä—Ç—ã</th>
                            <th class="px-4 py-3">–•–æ—Å—Ç</th>
                            <th class="px-4 py-3 text-right">–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="container-list" class="divide-y divide-gray-700">
                        {% include "partials/container_rows.html" %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Logs -->
<dialog id="log-modal" class="bg-transparent p-0 w-full max-w-4xl backdrop:bg-black/80">
    <div class="bg-gray-900 border border-gray-700 rounded-lg shadow-2xl flex flex-col max-h-[90vh]">
        <div class="p-4 border-b border-gray-800 flex justify-between items-center bg-gray-800 rounded-t-lg">
            <h3 class="font-bold">–õ–æ–≥–∏ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞</h3>
            <button onclick="document.getElementById('log-modal').close()"
                class="text-gray-400 hover:text-white">‚úï</button>
        </div>
        <div id="modal-content" class="p-4 overflow-auto flex-1 font-mono text-xs text-gray-300 whitespace-pre-wrap">
            –ó–∞–≥—Ä—É–∑–∫–∞...
        </div>
    </div>
</dialog>
{% endblock %}